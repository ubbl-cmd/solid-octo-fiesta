create_ripes_lib(version LINK_TO_RIPES_LIB)

# -----------------------------------------------------------------------------
# Version control file
# A file gen_versionnumber.h is generated by version.cmake, containing information
# regarding the current .git revision.
# This information is embedded into the binary for future reference, ie. for issue
# reporting.
add_custom_target(
    version_file ALL
    # Depend on the dummy file (which is not generated by the versioning script)
    # to ensure that the custom command is executed each time the project is built.
    DEPENDS ${CMAKE_CURRENT_BINARY_DIR}/dummy.cpp
    )

add_dependencies(version_lib version_file)

add_custom_command(
    OUTPUT
        # Dummy file not generated by the sript, but may be used as a dependency
        ${CMAKE_CURRENT_BINARY_DIR}/dummy.cpp
    COMMAND
        ${CMAKE_COMMAND}
            -DRIPES_SRC_DIR=${CMAKE_SOURCE_DIR}
            -P ${CMAKE_CURRENT_SOURCE_DIR}/version.cmake)
